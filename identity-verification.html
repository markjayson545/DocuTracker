<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocuTracker: Verify your Identity</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-player/1.4.3/lottie-player.js"></script>

    <script src="js/services/check-session.js"></script>
    <script src="js/services/logout.js"></script>
    <script src="js/client/identity-verification/identity-verification.js"></script>
    <script src="js/services/open-user-menu.js"></script>
    <script src="js/client/identity-verification/fetch-personal-info-contact-address.js"></script>
    <script src="js/client/identity-verification/save-personal-info-contact-address.js"></script>
    <script src="js/client/identity-verification/validate-inputs.js"></script>
    <script src="js/client/identity-verification/upload-verification-document.js"></script>
        <script src="js/services/upload-user-profile.js"></script>
    <!-- Global CSS First -->
    <!-- Then Page-specific CSS -->

    <!-- External Libraries -->

    <!-- Global CSS First -->
    <link rel="stylesheet" href="css/global/master.css">
    <!-- Then Page-specific CSS -->
    <link rel="stylesheet" href="css/identity-verification.css">

    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-player/1.4.3/lottie-player.js"></script>

</head>

<body>
    <header>
        <a href="index.html">
            <h2>
                <i class="fas fa-file-invoice"></i> DocuTrack
            </h2>
        </a>
        <ul>
            <li>
                <a href="index.html"><i class="fas fa-home"></i> Home</a>
            </li>
            <li>
                <a href="HowitWorks"><i class="fas fa-cogs"></i> How it Works</a>
            </li>
            <li>
                <a href="FAQ"><i class="fas fa-question-circle"></i> FAQ</a>
            </li>
            <li>
                <a href="Contact"><i class="fas fa-envelope"></i> Contact</a>
            </li>
        </ul>

        <div class="login-or-create" id="login-or-create">
            <div class="login-button">
                <a href="sign-in.html"><i class="fas fa-sign-in-alt"></i> Login</a>
            </div>
            <div class="signup-button">
                <a href="sign-up.html"><i class="fas fa-user-plus"></i> Sign Up</a>
            </div>
        </div>

        <div class="user-info" id="user-info">
            <div class="user-icon">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="user-details">
                <p class="user-name" id="user-name">John Doe</p>
                <p class="user-email" id="user-email">example@email.com</p>
            </div>
            <div class="user-dropdown" id="user-dropdown">
                <div class="user-info-dropdown">
                    <div class="user-icon">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="user-details">
                        <p class="user-name" id="user-name">John Doe</p>
                        <p class="user-email" id="user-email">markjayson545@gmail.com</p>
                    </div>
                </div>
                <hr>
                <!-- <ul class="dropdown-menu">
                    <li id="user-dashboard-btn">
                        <a href="user-dashboard.html">
                            <i class="fas fa-tachometer-alt"></i>
                            Dashboard
                        </a>
                    </li>
                    <li id="identity-verification-btn">
                        <a href="identity-verification.html">
                            <i class="fas fa-id-card"></i>
                            Identity Verification
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="fas fa-user"></i>
                            Profile
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="fas fa-cog"></i>
                            Settings
                        </a>
                    </li>
                </ul> -->
                <hr>
                <button id="logout-button" class="logout-button">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
            <button id="dropdown-button" class="dropdown-button" title="dropdown-button">
                <i class="fa-solid fa-caret-down"></i>
            </button>
        </div>

    </header>

    <main class="main-content">

        <div class="status">
            <div class="step personal-details active" id="personal-details-step-class">
                <i class="fas fa-address-book"></i>
                <h3>Personal Information</h3>
                <p>Basic Information</p>
                <div class="step-indicator"></div>
            </div>
            <hr class="progress-line active" id="progress-line-step-0">
            <div class="step verify-identity" id="verify-identity-step-class">
                <i class="fas fa-user-check"></i>
                <h3>Verify Identity</h3>
                <p>Upload Identification Documents</p>
                <div class="step-indicator"></div>
            </div>
            <hr class="progress-line" id="progress-line-step-1">
            <div class="step processing" id="processing-step-class">
                <i class="fas fa-cogs"></i>
                <h3>Processing</h3>
                <p>Review and Approval</p>
                <div class="step-indicator"></div>
            </div>
        </div>

        <div class="personal-details-form" id="personal-details-form">
            <div class="welcome-message">
                <h2>Welcome to DocuTracker</h2>
                <p>Let's get started with your personal information</p>
            </div>
            <form id="personal-info-form">
                <div class="personal-details-group">
                    <fieldset class="personal-details">
                        <legend>Personal Information</legend>
                        <div class="form-animation">
                            <lottie-player src="assets/verification-process/personal-details.json"
                                background="transparent" speed="1" style="width: 200px; height: 200px" loop autoplay>
                            </lottie-player>
                            <p class="animation-text">Please complete your personal information below</p>
                        </div>
                        <div class="form-group">
                            <label for="first-name">First Name</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user"></i>
                                <input type="text" id="first-name" name="first-name" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="last-name">Last Name</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user-tag"></i>
                                <input type="text" id="last-name" name="last-name" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="middle-name">Middle Name</label>
                            <div class="input-with-icon">
                                <i class="fas fa-user-edit"></i>
                                <input type="text" id="middle-name" name="middle-name">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="qualifier">Qualifier</label>
                            <div class="input-with-icon">
                                <i class="fas fa-id-badge"></i>
                                <select name="qualifier" id="qualifier" required>
                                    <option value="" disabled selected>Select a qualifier</option>
                                    <option value="none">None</option>
                                    <option value="jr">Jr</option>
                                    <option value="sr">Sr</option>
                                    <option value="ii">II</option>
                                    <option value="iii">III</option>
                                    <option value="iv">IV</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="contact-address">
                        <legend>Contact Address</legend>
                        <div class="form-animation">
                            <lottie-player src="assets/verification-process/contact-address.json"
                                background="transparent" speed="1" loop autoplay>
                            </lottie-player>
                            <p class="animation-text">Where can we reach you?</p>
                        </div>
                        <div class="form-group">
                            <label for="house-num">House no.</label>
                            <div class="input-with-icon">
                                <i class="fas fa-home"></i>
                                <input type="house-num" id="house-num" name="house-num" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="street">Street</label>
                            <div class="input-with-icon">
                                <i class="fas fa-road"></i>
                                <input type="text" id="street" name="street" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="province">Province</label>
                            <div class="input-with-icon">
                                <i class="fas fa-map"></i>
                                <select id="province" name="province" required>
                                    <option value="" selected disabled>Select Province</option>
                                    <!-- Will be populated via API -->
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="city">City/Municipality</label>
                            <div class="input-with-icon">
                                <i class="fas fa-city"></i>
                                <select id="city" name="city" required>
                                    <option value="" selected disabled>Select City/Municipality</option>
                                    <!-- Will be populated via API -->
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="barangay">Barangay</label>
                            <div class="input-with-icon">
                                <i class="fas fa-map-marker-alt"></i>
                                <select id="barangay" name="barangay" required>
                                    <option value="" selected disabled>Select Barangay</option>
                                    <!-- Will be populated via API -->
                                </select>
                            </div>
                        </div>
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                const provinceSelect = document.getElementById('province');
                                const citySelect = document.getElementById('city');
                                const barangaySelect = document.getElementById('barangay');

                                // Fetch provinces
                                fetch('https://psgc.gitlab.io/api/provinces/')
                                    .then(response => response.json())
                                    .then(provinces => {
                                        provinces.sort((a, b) => a.name.localeCompare(b.name));
                                        provinces.forEach(province => {
                                            const option = document.createElement('option');
                                            option.value = province.name; // Set value to name
                                            option.textContent = province.name;
                                            option.dataset.code = province.code; // Store code in data-code attribute
                                            provinceSelect.appendChild(option);
                                        });
                                    })
                                    .catch(error => console.error('Error loading provinces:', error));

                                // Load cities when province is selected
                                provinceSelect.addEventListener('change', function () {
                                    const selectedOption = this.options[this.selectedIndex];
                                    const provinceCode = selectedOption.dataset ? selectedOption.dataset.code : null; // Get code from data-code

                                    citySelect.innerHTML = '<option value="" selected disabled>Select City/Municipality</option>';
                                    barangaySelect.innerHTML = '<option value="" selected disabled>Select Barangay</option>';

                                    if (provinceCode) { // Only fetch if a valid province code is available
                                        fetch(`https://psgc.gitlab.io/api/provinces/${provinceCode}/cities-municipalities/`)
                                            .then(response => response.json())
                                            .then(cities => {
                                                cities.sort((a, b) => a.name.localeCompare(b.name));
                                                cities.forEach(city => {
                                                    const option = document.createElement('option');
                                                    option.value = city.name; // Set value to name
                                                    option.textContent = city.name;
                                                    option.dataset.code = city.code; // Store code in data-code attribute
                                                    citySelect.appendChild(option);
                                                });
                                            })
                                            .catch(error => console.error('Error loading cities:', error));
                                    }
                                });

                                // Load barangays when city is selected
                                citySelect.addEventListener('change', function () {
                                    const selectedOption = this.options[this.selectedIndex];
                                    const cityCode = selectedOption.dataset ? selectedOption.dataset.code : null; // Get code from data-code

                                    barangaySelect.innerHTML = '<option value="" selected disabled>Select Barangay</option>';

                                    if (cityCode) { // Only fetch if a valid city code is available
                                        fetch(`https://psgc.gitlab.io/api/cities-municipalities/${cityCode}/barangays/`)
                                            .then(response => response.json())
                                            .then(barangays => {
                                                barangays.sort((a, b) => a.name.localeCompare(b.name));
                                                barangays.forEach(barangay => {
                                                    const option = document.createElement('option');
                                                    option.value = barangay.name; // Set value to name
                                                    option.textContent = barangay.name;
                                                    // No data-code needed for barangay options as they are the last in this chain
                                                    barangaySelect.appendChild(option);
                                                });
                                            })
                                            .catch(error => console.error('Error loading barangays:', error));
                                    }
                                });
                            });
                        </script>
                    </fieldset>
                    <fieldset class="more-info">
                        <legend>More Information</legend>
                        <div class="form-group">
                            <label for="sex">Sex</label>
                            <div class="input-with-icon">
                                <i class="fas fa-venus-mars"></i>
                                <select name="sex" id="sex">
                                    <option value="" selected disabled>Select Sex</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                    <option value="prefer-not-to-say">Prefer not to say</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="civil-status">Civil Status</label>
                            <div class="input-with-icon">
                                <i class="fas fa-ring"></i>
                                <select name="civil-status" id="civil-status">
                                    <option value="" selected disabled>Select Civil Status</option>
                                    <option value="single">Single</option>
                                    <option value="married">Married</option>
                                    <option value="widowed">Widowed</option>
                                    <option value="separated">Separated</option>
                                    <option value="divorced">Divorced</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="dob">Date of Birth</label>
                            <div class="input-with-icon">
                                <i class="fas fa-calendar-alt"></i>
                                <input type="date" id="dob" name="dob" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="birth-place">Birth Place</label>
                            <div class="input-with-icon">
                                <i class="fas fa-map-marker-alt"></i>
                                <input type="text" id="birth-place" name="birth-place" required>
                            </div>
                        </div>
                        <div class="form-group height-weight-group">
                            <div class="input-group">
                                <label for="height">Height (cm)</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-ruler-vertical"></i>
                                    <input type="text" id="height" name="height" required>
                                </div>
                            </div>
                            <div class="input-group">
                                <label for="weight">Weight (kg)</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-weight"></i>
                                    <input type="text" id="weight" name="weight" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="nationality">Nationality</label>
                            <div class="input-with-icon">
                                <i class="fas fa-flag"></i>
                                <select name="nationality" id="nationality" required></select>
                            </div>
                            <!-- Will be populated from API -->
                            </select>
                            <script>
                                // Fetch nationalities from REST Countries API
                                document.addEventListener('DOMContentLoaded', function () {
                                    fetch('https://restcountries.com/v3.1/all')
                                        .then(response => response.json())
                                        .then(data => {
                                            const nationalitySelect = document.getElementById('nationality');
                                            // Add default disabled option
                                            const defaultOption = document.createElement('option');
                                            defaultOption.value = "";
                                            defaultOption.textContent = "Select Nationality";
                                            defaultOption.selected = true;
                                            defaultOption.disabled = true;
                                            nationalitySelect.appendChild(defaultOption);

                                            // Sort countries by name
                                            data.sort((a, b) => a.name.common.localeCompare(b.name.common));

                                            data.forEach(country => {
                                                const option = document.createElement('option');
                                                option.value = country.name.common.toLowerCase();
                                                option.textContent = country.name.common;
                                                nationalitySelect.appendChild(option);
                                            });
                                        })
                                        .catch(error => {
                                            console.error('Error fetching nationalities:', error);
                                            // Fallback to some common nationalities if API fails
                                            const nationalitySelect = document.getElementById('nationality');
                                            // Add default disabled option
                                            const defaultOption = document.createElement('option');
                                            defaultOption.value = "";
                                            defaultOption.textContent = "Select Nationality";
                                            defaultOption.selected = true;
                                            defaultOption.disabled = true;
                                            nationalitySelect.appendChild(defaultOption);

                                            const fallbackOptions = ['Filipino', 'American', 'British', 'Chinese', 'Indian'];
                                            fallbackOptions.forEach(nationality => {
                                                const option = document.createElement('option');
                                                option.value = nationality.toLowerCase();
                                                option.textContent = nationality;
                                                nationalitySelect.appendChild(option);
                                            });
                                        });
                                });
                            </script>
                        </div>
                        <div class="form-group">
                            <label for="complexion">Complexion</label>
                            <div class="input-with-icon">
                                <i class="fas fa-palette"></i>
                                <select name="complexion" id="complexion">
                                    <option value="" selected disabled>Select Complexion</option>
                                    <option value="fair">Fair</option>
                                    <option value="light">Light</option>
                                    <option value="medium">Medium</option>
                                    <option value="dark">Dark</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="blood-type">Blood Type</label>
                            <div class="input-with-icon">
                                <i class="fas fa-tint"></i>
                                <select name="blood-type" id="blood-type">
                                    <option value="" selected disabled>Select Blood Type</option>
                                    <option value="unknown">Unknown</option>
                                    <option value="a+">A+</option>
                                    <option value="a-">A-</option>
                                    <option value="b+">B+</option>
                                    <option value="b-">B-</option>
                                    <option value="ab+">AB+</option>
                                    <option value="ab-">AB-</option>
                                    <option value="o+">O+</option>
                                    <option value="o-">O-</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="religion">Religion</label>
                            <div class="input-with-icon">
                                <i class="fas fa-pray"></i>
                                <select name="religion" id="religion">
                                    <option value="" selected disabled>Select Religion</option>
                                    <option value="roman-catholic">Roman Catholic</option>
                                    <option value="protestant">Protestant</option>
                                    <option value="islam">Islam</option>
                                    <option value="buddhism">Buddhism</option>
                                    <option value="hinduism">Hinduism</option>
                                    <option value="judaism">Judaism</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="education">Education</label>
                            <div class="input-with-icon">
                                <i class="fas fa-graduation-cap"></i>
                                <select name="education" id="education">
                                    <option value="" selected disabled>Select Education</option>
                                    <option value="elementary">Elementary</option>
                                    <option value="high-school">High School</option>
                                    <option value="high-school-undergraduate">High School Undergraduate</option>
                                    <option value="college">College</option>
                                    <option value="college-undergraduate">College Undergraduate</option>
                                    <option value="masters">Masters</option>
                                    <option value="doctorate">Doctorate</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="occupation">Occupation</label>
                            <div class="input-with-icon">
                                <i class="fas fa-briefcase"></i>
                                <select name="occupation" id="occupation">
                                    <option value="" selected disabled>Select Occupation</option>
                                    <option value="student">Student</option>
                                    <option value="employed">Employed</option>
                                    <option value="unemployed">Unemployed</option>
                                    <option value="self-employed">Self-Employed</option>
                                    <option value="retired">Retired</option>
                                    <option value="housewife">Housewife</option>
                                    <option value="ofw">OFW</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                </div>
                <button type="submit" class="next-button" style="color: aliceblue;">
                    <i class="fas fa-arrow-right"></i> Next Step
                </button>
            </form>
        </div>

        <div class="upload-verification-document" id="upload-verification-document">
            <!-- <button id="back-button">
                <i class="fa-solid fa-arrow-left"></i>
                Previous Step
            </button> -->

            <div class="verification-container">
                <div class="verification-info">
                    <h3>Identity Verification</h3>
                    <lottie-player src="assets/verification-process/identity-verification.json" background="transparent"
                        speed="1" loop autoplay>
                    </lottie-player>
                    <p>Please upload a valid identification document to verify your identity.</p>
                </div>

                <div class="verification-form-container">
                    <form id="upload-verification-form">
                        <div class="document-type-container">
                            <label for="document-type">Select Document Type</label>
                            <select name="document-type" id="document-type" required>
                                <option value="" disabled selected>Select Document Type</option>
                                <option value="drivers-license">Driver's License</option>
                                <option value="passport">Passport</option>
                                <option value="national-id">National ID</option>
                            </select>
                        </div>
                        <fieldset class="upload-document-container">
                            <label for="verification-document">Upload Document</label>
                            <input type="file" name="verification-document" id="verification-document" required>
                            <div class="drag-drop-indicator">
                                <span><i class="fas fa-cloud-upload-alt"></i> Drop file here</span>
                            </div>
                        </fieldset>
                        <div id="document-preview-container" class="document-preview-container" style="display: none;">
                        </div>
                        <div class="upload-progress-container">
                            <div class="upload-progress-bar"></div>
                        </div>
                        <button type="submit">
                            <i class="fas fa-upload"></i> Upload Document
                        </button>
                    </form>
                    <div id="uploaded-documents-list" class="uploaded-documents-list">
                        <h4>Uploaded Documents</h4>
                        <table id="documents-table">
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Preview</th>
                                    <th>Date Uploaded</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="processing-status">
            <div class="status-title-container">
                <h2 class="status-title">
                    Application Submitted Sucessfully
                </h2>
                <p class="status-message">
                    Your application has been submitted successfully. Please wait for the approval of your application.
                </p>
            </div>

            <div class="process-steps">
                <div class="step-process submitted">
                    <i class="fas fa-check active"></i>
                    <p>Submitted</p>
                </div>
                <hr class="progress-line">
                <div class="step-process under-review">
                    <i class="fas fa-search"></i>
                    <p>Under Review</p>
                </div>
                <hr class="progress-line">
                <div class="step-process verified">
                    <i class="fas fa-user-check"></i>
                    <p>Verified</p>
                </div>
            </div>
            <div class="process-info">
                <div class="submitted-info">
                    <h3>Submitted</h3>
                    <p>Your application has been submitted successfully.</p>
                </div>
                <div class="under-review-info">
                    <h3>Under Review</h3>
                    <p>Your application is currently under review. Please wait for the approval of your application.</p>
                </div>
                <div class="verified-info">
                    <h3>Verified</h3>
                    <p>Your application has been approved. You can now access the services of DocuTracker.</p>
                </div>
                <div class="application-details">
                    <h3>Application Details</h3>
                    <div class="application-details-group">
                        <div class="application-detail">
                            <p>Application ID</p>
                            <p id="application-id">123456789</p>
                        </div>
                        <div class="application-detail">
                            <p>Submission Date</p>
                            <p id="application-date">October 1, 2021</p>
                        </div>
                        <div class="application-detail">
                            <p>Status</p>
                            <p id="application-status">Under Review</p>
                        </div>
                    </div>
                    <!-- <button id="edit-application-button">
                        <i class="fas fa-edit"></i>
                        Edit Application
                    </button> -->
                </div>
            </div>
        </div>

    </main>

    <footer>
        <div class="about-us">
            <h3><i class="fas fa-info-circle"></i> About Us</h3>
            <p>Providing secure and efficient document<br> processing services.</p>
            <div class="social-media">
                <div class="social-media-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>

        <div class="quick-links">
            <h3><i class="fas fa-link"></i> Quick Links</h3>
            <ul>
                <li><a href="terms"><i class="fas fa-file-contract"></i> Terms of Service</a></li>
                <li><a href="privacy-policy"><i class="fas fa-user-shield"></i> Privacy Policy</a></li>
            </ul>
        </div>

        <div class="contacts">
            <h3><i class="fas fa-address-book"></i> Contact Us</h3>
            <div class="email">
                <i class="fas fa-envelope"></i>
                <a href="mailto:example@email.com">example@email.com</a>
            </div>
            <div class="telephone">
                <i class="fas fa-phone-alt"></i>
                <a href="tel:+639123456789">+639123456789</a>
            </div>
        </div>
    </footer>
</body>

</html>